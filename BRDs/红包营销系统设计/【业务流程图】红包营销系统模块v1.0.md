# 【业务流程图】红包营销系统模块v1.0

## 1. 红包活动创建流程

### 1.1 完整创建流程图

```mermaid
graph TB
    A[开始创建红包] --> B[选择红包类型]
    B --> C{红包类型}
    C -->|普通红包| D[配置普通红包属性]
    C -->|裂变红包| E[配置裂变红包属性]
    D --> F[配置红包基本信息]
    E --> F
    F --> G[设置有效期]
    G --> H{有效期类型}
    H -->|固定时间| I[选择开始结束时间]
    H -->|相对天数| J[设置有效天数]
    I --> K[配置周期规则]
    J --> K
    K --> L[设置用户限制条件]
    L --> M[配置页面内容]
    M --> N[上传油站标志]
    N --> O[设置页面标题和标语]
    O --> P[编辑活动规则]
    P --> Q[进入营销券选择]
    Q --> R[搜索和选择营销券]
    R --> S{是否选择了券}
    S -->|否| T[提示选择营销券]
    T --> R
    S -->|是| U[进入红包设置]
    U --> V[设置红包发行数量]
    V --> W[配置各券种数量]
    W --> X[系统计算总预算]
    X --> Y[预览活动信息]
    Y --> Z[输入操作密码]
    Z --> AA{密码验证}
    AA -->|失败| BB[提示密码错误]
    BB --> Z
    AA -->|成功| CC[创建红包活动]
    CC --> DD[生成活动链接]
    DD --> EE[生成二维码]
    EE --> FF[创建完成]
```

### 1.2 红包类型配置流程

```mermaid
graph TB
    A[选择红包类型] --> B{红包类型}
    B -->|普通红包| C[普通红包配置]
    B -->|裂变红包| D[裂变红包配置]
    C --> E[一个活动发行一波红包]
    C --> F[用户满足条件可主动领取一次]
    D --> G[可设置为满额送奖励]
    D --> H[获得裂变红包可分享给好友]
    D --> I[好友通过分享可领取优惠券]
    E --> J[进入基本信息配置]
    F --> J
    G --> J
    H --> J
    I --> J
```

### 1.3 用户限制条件配置流程

```mermaid
graph TB
    A[配置用户限制] --> B[设置身份条件]
    B --> C{身份条件}
    C -->|不限| D[所有身份可参与]
    C -->|选中可参与| E[选择允许的身份类型]
    C -->|选中不可参与| F[选择禁止的身份类型]
    D --> G[设置会员等级限制]
    E --> G
    F --> G
    G --> H{会员等级}
    H -->|不限制| I[所有等级可参与]
    H -->|限制会员等级| J[选择允许的会员等级]
    I --> K[设置领取用户类型]
    J --> K
    K --> L{用户类型}
    L -->|所有用户| M[新老用户都可领取]
    L -->|未加油用户| N[仅新用户可领取]
    M --> O[设置重复领取规则]
    N --> O
```

## 2. 红包活动管理流程

### 2.1 红包记录查看流程

```mermaid
graph TB
    A[访问红包记录页面] --> B[加载红包列表]
    B --> C[显示状态筛选]
    C --> D{选择状态筛选}
    D -->|全部| E[显示所有红包]
    D -->|未开始| F[显示未开始红包]
    D -->|进行中| G[显示进行中红包]
    D -->|已结束| H[显示已结束红包]
    E --> I[显示红包列表]
    F --> I
    G --> I
    H --> I
    I --> J[分页显示]
    J --> K{用户操作}
    K -->|查看详情| L[进入红包详情页]
    K -->|翻页| M[加载其他页面数据]
    L --> N[显示红包详细信息]
    N --> O[显示H5页面预览]
    O --> P[显示营销券详情]
    P --> Q[显示活动链接和二维码]
    M --> I
```

### 2.2 红包活动操作流程

```mermaid
graph TB
    A[红包详情页面] --> B[选择操作类型]
    B --> C{操作类型}
    C -->|暂停活动| D[暂停活动确认]
    C -->|延迟活动| E[设置延迟时间]
    C -->|删除活动| F[删除活动确认]
    C -->|查看营销券| G[打开营销券详情]
    D --> H[输入操作密码]
    E --> I[选择延迟到的时间]
    F --> H
    G --> J[显示营销券详细信息]
    I --> H
    H --> K{密码验证}
    K -->|验证失败| L[提示密码错误]
    K -->|验证成功| M[执行操作]
    L --> H
    M --> N[更新活动状态]
    N --> O[操作完成提示]
    J --> P[关闭详情弹窗]
```

## 3. 红包统计分析流程

### 3.1 数据统计查看流程

```mermaid
graph TB
    A[访问统计页面] --> B[选择要分析的活动]
    B --> C[加载活动数据]
    C --> D[显示数据概览]
    D --> E[发放数量统计]
    D --> F[领取数量统计]
    D --> G[使用数量统计]
    D --> H[领取人数统计]
    D --> I[使用人数统计]
    D --> J[成本数据统计]
    E --> K[用户选择时间范围]
    F --> K
    G --> K
    H --> K
    I --> K
    J --> K
    K --> L{时间范围}
    L -->|最近7天| M[加载7天数据]
    L -->|最近30天| N[加载30天数据]
    L -->|自定义时间| O[选择自定义日期范围]
    M --> P[生成数据趋势图]
    N --> P
    O --> P
    P --> Q[用户选择数据类型]
    Q --> R{数据类型}
    R -->|营销券数据| S[显示券相关趋势]
    R -->|人数数据| T[显示人数相关趋势]
    R -->|成本数据| U[显示成本相关趋势]
    S --> V[显示详细数据表格]
    T --> V
    U --> V
    V --> W{用户操作}
    W -->|保存图片| X[下载趋势图]
    W -->|导出报表| Y[下载Excel报表]
    W -->|查看其他活动| Z[切换活动]
    Z --> B
```

### 3.2 集团数据和各站数据切换流程

```mermaid
graph TB
    A[统计页面加载] --> B{用户类型}
    B -->|集团用户| C[显示数据切换选项]
    B -->|普通用户| D[只显示当前站点数据]
    C --> E{数据类型选择}
    E -->|集团数据| F[显示集团汇总数据]
    E -->|各站使用情况| G[显示各站点数据]
    F --> H[集团级别数据概览]
    G --> I[各站点使用数据]
    H --> J[集团级别趋势图]
    I --> K[各站点对比图表]
    D --> L[当前站点数据]
    L --> M[站点数据趋势]
```

## 4. 营销券选择和配置流程

### 4.1 营销券选择流程

```mermaid
graph TB
    A[进入营销券选择] --> B[加载可用营销券列表]
    B --> C[显示券列表表格]
    C --> D[显示搜索框]
    D --> E{用户操作}
    E -->|搜索营销券| F[输入搜索关键词]
    E -->|全选营销券| G[选中所有券]
    E -->|单选营销券| H[选中特定券]
    E -->|查看券详情| I[打开券详情弹窗]
    E -->|创建新券| J[跳转到券创建页面]
    F --> K[过滤显示匹配的券]
    G --> L[统计已选券数量]
    H --> L
    I --> M[显示券的详细信息]
    J --> N[创建新营销券]
    K --> O{搜索结果}
    O -->|有结果| P[显示匹配的券]
    O -->|无结果| Q[显示无数据提示]
    L --> R{是否有选中券}
    R -->|是| S[启用下一步按钮]
    R -->|否| T[禁用下一步按钮]
    M --> U[关闭详情弹窗]
    N --> V[返回券选择页面]
    P --> E
    Q --> E
    S --> W[进入红包设置]
    V --> B
```

### 4.2 红包数量和预算配置流程

```mermaid
graph TB
    A[进入红包设置] --> B[显示已选营销券]
    B --> C[设置红包发行数量]
    C --> D[为每种券设置数量]
    D --> E[实时计算总预算]
    E --> F{预算计算}
    F --> G[发行数量 × 券额 × 券数量]
    G --> H[显示预算总额]
    H --> I{用户操作}
    I -->|增加红包数量| J[点击+号增加]
    I -->|减少红包数量| K[点击-号减少]
    I -->|修改券数量| L[修改单券数量]
    I -->|设置浏览器领取| M[选择是否支持浏览器]
    J --> N[验证数量限制]
    K --> O[验证最小数量]
    L --> P[重新计算预算]
    M --> Q[更新领取方式配置]
    N --> R{数量是否有效}
    O --> R
    R -->|有效| S[更新显示数量]
    R -->|无效| T[提示错误信息]
    P --> H
    Q --> U[配置完成确认]
    S --> E
    T --> I
    U --> V[进入确认信息页面]
```

## 5. 系统交互流程

### 5.1 前后端数据交互流程

```mermaid
graph TB
    A[前端页面加载] --> B[发送数据请求]
    B --> C[后端接收请求]
    C --> D[验证请求参数]
    D --> E{参数验证}
    E -->|验证失败| F[返回错误信息]
    E -->|验证成功| G[处理业务逻辑]
    F --> H[前端显示错误提示]
    G --> I[数据库操作]
    I --> J{操作结果}
    J -->|成功| K[返回成功数据]
    J -->|失败| L[返回失败信息]
    K --> M[前端更新页面显示]
    L --> N[前端显示操作失败]
    H --> O[用户重新操作]
    M --> P[操作完成]
    N --> O
    O --> A
```

### 5.2 文件上传处理流程

```mermaid
graph TB
    A[用户选择文件] --> B[前端验证文件]
    B --> C{文件验证}
    C -->|格式不符| D[提示格式错误]
    C -->|大小超限| E[提示大小错误]
    C -->|验证通过| F[显示上传进度]
    D --> G[用户重新选择]
    E --> G
    F --> H[发送文件到服务器]
    H --> I[服务器接收文件]
    I --> J[服务器验证文件]
    J --> K{服务器验证}
    K -->|验证失败| L[返回上传失败]
    K -->|验证成功| M[保存文件]
    L --> N[显示上传失败提示]
    M --> O[返回文件路径]
    O --> P[更新页面预览]
    P --> Q[保存文件信息]
    G --> A
    N --> G
```