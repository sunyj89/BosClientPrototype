# 商业需求文档 (BRD) - 红包营销系统

## 1. 模块概述 (Project Overview)

### 1.1 模块目标与价值 (Project Goals and Value Proposition)
主要目标：提供一个完整的红包营销活动管理系统，支持商户创建、管理和监控红包营销活动，通过红包形式分发营销券以提升用户粘性和促进消费。

核心价值：
- 为商户提供灵活的红包营销工具，支持多种红包类型和分发策略
- 通过可视化的活动配置界面，简化营销活动创建流程
- 提供详细的数据统计分析，帮助商户优化营销策略
- 支持社交分享功能，实现裂变营销效果

### 1.2 模块范围 (Project Scope)
核心功能模块：
- 红包活动创建模块：支持普通红包和裂变红包的创建配置
- 营销券管理模块：管理红包内包含的各类营销券
- 红包记录管理模块：查看和管理已创建的红包活动
- 红包统计分析模块：提供数据概览、趋势分析和详细报表

本次迭代：基于当前代码逻辑的完整功能范围，包含红包全生命周期管理。

## 2. 用户分析 (User Analysis)

### 2.1 用户场景 (User Scenarios)
* **商户管理员创建红包活动**：管理员需要为即将到来的促销活动创建红包，他会通过以下步骤：1. 访问红包创建页面(`createRedPackage.blade.php`) 2. 配置红包基本属性(名称、类型、有效期等) 3. 选择包含的营销券类型和数量 4. 设置红包发行数量和预算 5. 预览并确认活动信息 6. 发布红包活动

* **商户查看红包活动效果**：商户希望了解红包活动的推广效果，他会：1. 访问红包统计页面(`redPackageStatics.blade.php`) 2. 选择要查看的活动 3. 查看数据概览(发放数量、领取数量、使用数量等) 4. 分析数据趋势图表 5. 导出详细数据报表进行深度分析

* **商户管理红包活动记录**：商户需要查看和管理历史红包活动，他会：1. 访问红包记录页面(`redPackageRecord.blade.php`) 2. 通过状态筛选(未开始、进行中、已结束)查看活动 3. 查看红包详情(`redPackageDetail.blade.php`) 4. 进行活动的暂停、延迟等操作

## 3. 产品需求 (Product Requirements)

### 3.1 功能需求 (Functional Requirements)

#### 模块一：红包活动创建模块
**FR1.1 红包基本属性配置**
- 描述：商户可以配置红包的基本属性，包括红包类型、名称、有效期等
- 输入：红包类型(普通红包/裂变红包)、红包名称、有效期、周期规则、身份条件、会员等级限制、领取用户类型、重复领取设置、分享设置、收费设置
- 处理逻辑：前端验证输入格式，支持固定时间和相对天数两种有效期设置，支持每日/每周/每月的周期重复规则
- 输出/预期结果：保存红包基本配置，进入下一步营销券选择

**FR1.2 页面内容配置**
- 描述：配置红包活动的H5展示页面内容，包括页面标题、油站标志、主标语等
- 输入：页面标题、油站标志图片、油站名称、主标语、活动规则文本
- 处理逻辑：支持图片上传和预览，实时显示H5页面效果，自动生成活动规则模板
- 输出/预期结果：生成红包活动的H5展示页面配置

**FR1.3 营销券选择**
- 描述：从现有营销券中选择要包含在红包中的券种
- 输入：营销券搜索关键词、营销券选择(支持多选)
- 处理逻辑：显示营销券列表(券名、券ID、券额、券类型、有效期)，支持全选和搜索筛选，支持查看券详情
- 输出/预期结果：确定红包包含的营销券列表

**FR1.4 红包数量和预算配置**
- 描述：设置红包发行数量，系统自动计算总预算
- 输入：红包发行数量、每种营销券的数量
- 处理逻辑：实时计算总预算(发行数量×券额×券数量)，支持浏览器领取设置
- 输出/预期结果：确定红包发行配置和预算

**FR1.5 活动确认和发布**
- 描述：预览完整活动信息并发布红包活动
- 输入：操作密码验证
- 处理逻辑：显示完整活动配置预览，验证操作密码，生成活动链接和二维码
- 输出/预期结果：成功创建红包活动，生成微信链接和浏览器链接

#### 模块二：红包记录管理模块
**FR2.1 红包活动列表查看**
- 描述：查看所有红包活动的列表，支持状态筛选
- 输入：活动状态筛选条件(全部/未开始/进行中/已结束)
- 处理逻辑：显示红包列表(红包类型、名称、ID、有效期、券数、红包数量)，支持分页
- 输出/预期结果：展示符合条件的红包活动列表

**FR2.2 红包活动详情查看**
- 描述：查看单个红包活动的详细信息
- 输入：红包活动ID
- 处理逻辑：显示完整的红包配置信息、H5页面预览、营销券详情、活动链接和二维码
- 输出/预期结果：展示红包活动的完整详情页面

**FR2.3 红包活动操作管理**
- 描述：对红包活动进行管理操作
- 输入：操作类型(暂停、延迟、删除等)、操作密码
- 处理逻辑：验证操作权限，执行相应的活动状态变更
- 输出/预期结果：完成活动状态变更，更新活动状态

#### 模块三：红包统计分析模块
**FR3.1 数据概览统计**
- 描述：展示红包活动的核心数据指标
- 输入：活动选择、时间范围选择
- 处理逻辑：统计发放数量、领取数量、使用数量、领取人数、使用人数、各类成本数据
- 输出/预期结果：显示数据概览卡片，包含关键指标和说明

**FR3.2 数据趋势分析**
- 描述：展示红包活动数据的时间趋势图表
- 输入：时间范围(最近7天/30天/自定义)、数据类型(营销券/人数/成本)
- 处理逻辑：生成折线图展示数据趋势，支持图表保存
- 输出/预期结果：显示可交互的数据趋势图表

**FR3.3 详细数据报表**
- 描述：提供按日期的详细数据表格和导出功能
- 输入：时间范围筛选
- 处理逻辑：按日期统计各项指标数据，支持报表导出
- 输出/预期结果：显示详细数据表格，支持Excel导出

### 3.2 数据需求 (Data Requirements)

#### 数据实体一：红包活动 (RedPackageActivity)
属性：活动ID、红包名称、红包类型、页面标题、有效期类型、有效期值、周期规则、身份条件、会员等级限制、领取用户类型、重复领取设置、分享设置、收费设置、次数限制、车牌号要求、页面模板、油站标志、油站名称、主标语、活动规则、创建时间、状态
来源：红包创建表单
存储：数据库红包活动表

#### 数据实体二：营销券 (MarketingCoupon)
属性：券ID、券名、券额、券类型、有效期、使用条件、创建时间、状态
来源：营销券管理系统
存储：数据库营销券表

#### 数据实体三：红包营销券关联 (RedPackageCouponRelation)
属性：关联ID、红包活动ID、营销券ID、券数量、发行数量
来源：红包配置过程
存储：数据库关联表

#### 数据实体四：红包统计数据 (RedPackageStatistics)
属性：统计ID、活动ID、统计日期、发放数量、领取数量、使用数量、领取人数、使用人数、计划成本、领取成本、使用成本
来源：用户行为统计
存储：数据库统计表

## 4. 核心业务流程 (Core Business Flows)

### 流程一：红包活动创建流程
1. 商户访问红包创建页面，选择红包类型(普通红包/裂变红包)
2. 配置红包基本属性：名称、有效期、周期规则、用户限制条件等
3. 配置页面内容：页面标题、油站标志、主标语、活动规则
4. 选择红包包含的营销券：从营销券列表中多选所需券种
5. 设置红包发行数量和各券种数量，系统计算总预算
6. 预览完整活动配置信息
7. 输入操作密码确认创建
8. 系统生成红包活动，返回活动链接和二维码

### 流程二：红包活动管理流程
1. 商户访问红包记录页面
2. 通过状态筛选查看不同状态的红包活动
3. 点击查看红包详情，系统展示完整活动信息
4. 根据需要进行活动操作(暂停、延迟、删除等)
5. 输入操作密码确认操作
6. 系统更新活动状态

### 流程三：红包数据分析流程
1. 商户访问红包统计页面
2. 选择要分析的红包活动
3. 系统展示数据概览：发放、领取、使用等核心指标
4. 选择时间范围和数据类型查看趋势图表
5. 查看详细数据表格
6. 根据需要导出数据报表进行进一步分析

## 5. 假设与约束 (Assumptions and Constraints)

### 技术假设
- 基于Laravel框架的Blade模板技术
- 前端使用jQuery、Bootstrap、Element UI等组件库
- 集成ECharts图表库进行数据可视化
- 支持文件上传功能(图片处理)
- 集成二维码生成功能

### 功能约束
- 红包类型目前支持普通红包和裂变红包两种
- 有效期设置支持固定时间和相对天数两种模式
- 周期规则支持每日、每周、每月三种重复模式
- 单个红包最多可包含多种营销券
- 需要操作密码验证进行关键操作

### 数据约束
- 红包名称最大长度30字符，显示限制15字符
- 页面标题最大长度30字符，显示限制12字符
- 主标语最大长度30字符，显示限制8字符
- 油站名称最大长度30字符，显示限制16字符
- 图片上传要求：1M以内，支持bmp、png、jpeg、jpg、gif格式
- 油站标志要求最小200*200px正方形尺寸