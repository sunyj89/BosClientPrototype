# 商业需求文档 (BRD) - 好友邀请营销系统

## 1. 模块概述 (Project Overview)

### 1.1 模块目标与价值 (Project Goals and Value Proposition)
主要目标：构建一个完整的好友邀请营销系统，通过用户社交关系链传播，实现用户拉新、用户活跃度提升和品牌推广的营销目标。系统支持多级邀请模式，通过奖励机制激励用户主动分享和邀请好友，形成裂变式增长。

核心价值：
- 降低获客成本：通过好友邀请机制，利用用户社交关系降低营销推广成本
- 提升用户粘性：通过奖励机制增强用户参与度和平台忠诚度
- 扩大用户规模：利用社交裂变效应实现用户规模快速增长
- 增强品牌传播：通过用户主动分享提升品牌知名度和影响力

### 1.2 模块范围 (Project Scope)
核心功能模块：
- 好友邀请活动创建管理模块
- 用户邀请关系管理模块
- 奖励发放与统计模块
- 页面模板配置模块
- 数据统计分析模块
- 邀请人名单管理模块

本次迭代：基于当前代码逻辑的完整功能范围，包含1级和2级好友邀请模式，支持多种奖励类型和完善的管理后台功能。

## 2. 用户分析 (User Analysis)

### 2.1 用户场景 (User Scenarios)
* **场景1：管理员创建邀请活动**
  管理员需要创建一个新的好友邀请活动来拉新用户。他会通过以下步骤：1. 访问创建页面（对应`create.blade.php`） 2. 设置活动基础信息（活动名称、时间、类型等） 3. 配置邀请人和被邀人资格 4. 设置页面模板和分享内容 5. 配置奖励规则和通知设置 6. 提交创建活动并生成邀请链接

* **场景2：用户发起邀请分享好友**
  已注册用户希望邀请好友获得奖励。他会：1. 打开邀请活动页面 2. 查看活动规则和奖励内容 3. 点击"发送邀请链接"或"面对面邀请" 4. 通过微信等渠道分享给好友 5. 等待好友接受邀请并完成条件

* **场景3：好友接受邀请并注册**
  收到邀请的新用户想要参与活动。他会：1. 点击邀请链接进入接受邀请页面 2. 查看邀请人信息和奖励内容 3. 输入手机号接受邀请 4. 注册成为平台用户 5. 根据活动要求完成特定行为（如加油消费）

* **场景4：管理员查看活动数据**
  管理员需要了解邀请活动的效果。他会：1. 访问活动列表页面（对应`lists.blade.php`） 2. 查看各个活动的参与情况 3. 点击详情查看具体邀请数据（对应`invite_detail.blade.php`） 4. 分析邀请转化率和奖励发放情况

## 3. 产品需求 (Product Requirements)

### 3.1 功能需求 (Functional Requirements)

#### 模块一：活动创建管理模块
**FR1.1 功能点名称：活动基础设置**
- 描述：管理员可以创建好友邀请活动，设置活动基础信息
- 输入：活动名称、活动时间、活动类型（1级/2级邀请、代理商模式）、页面标题、活动logo、活动规则
- 处理逻辑：验证活动信息完整性，保存活动基础配置，生成活动唯一标识
- 输出/预期结果：活动创建成功，生成活动ID，可进入下一步配置

**FR1.2 功能点名称：参与资格配置**
- 描述：设置邀请人和被邀人的参与资格条件
- 输入：邀请人资格（所有用户/加过油用户/已注册会员/认证代理商）、被邀人资格（未加油用户/未注册会员）
- 处理逻辑：根据业务规则验证资格设置的合理性，保存资格配置
- 输出/预期结果：资格配置保存成功，用于后续用户参与验证

**FR1.3 功能点名称：页面模板设置**
- 描述：配置邀请页面的展示内容和视觉效果
- 输入：页面标题、主标语、引导标语、提示语、背景图片、banner图片、默认模板选择
- 处理逻辑：文件上传处理，图片格式和大小验证，模板配置保存
- 输出/预期结果：页面模板配置完成，可预览页面效果

**FR1.4 功能点名称：分享设置**
- 描述：配置分享到微信好友和朋友圈的内容
- 输入：分享标题、分享内容、分享logo
- 处理逻辑：分享内容格式验证，图片上传处理
- 输出/预期结果：分享配置完成，支持微信分享功能

#### 模块二：奖励机制管理模块
**FR2.1 功能点名称：邀请人奖励设置**
- 描述：配置邀请人在不同阶段获得的奖励
- 输入：好友接受邀请时奖励（抵用券/积分/积分+经验值/微信红包）、好友完成邀请时奖励、通知消息设置
- 处理逻辑：奖励类型验证，数量限制检查，营销券关联验证
- 输出/预期结果：奖励规则保存成功，系统可自动发放奖励

**FR2.2 功能点名称：被邀人奖励设置**
- 描述：配置被邀请人接受邀请时的奖励
- 输入：奖励类型（抵用券/积分/油品优惠等）、奖励数量
- 处理逻辑：奖励配置验证，库存检查
- 输出/预期结果：被邀人奖励规则配置完成

**FR2.3 功能点名称：完成邀请条件设置**
- 描述：设置被邀请人完成邀请需要满足的条件
- 输入：完成方式（注册即完成/加油满足条件）、有效时间、加油门槛设置
- 处理逻辑：条件合理性验证，时间范围检查
- 输出/预期结果：完成邀请条件配置保存

#### 模块三：活动运营管理模块
**FR3.1 功能点名称：活动列表查看**
- 描述：管理员可以查看所有好友邀请活动的列表
- 输入：状态筛选条件（未开始/进行中/已结束）
- 处理逻辑：根据筛选条件查询活动数据，分页显示
- 输出/预期结果：显示活动列表，包含活动名称、ID、有效期、链接等信息

**FR3.2 功能点名称：活动详情查看**
- 描述：查看特定活动的详细配置和运营数据
- 输入：活动ID
- 处理逻辑：查询活动完整配置信息，关联统计数据
- 输出/预期结果：显示活动详细信息，包括页面预览、奖励设置、参与情况等

**FR3.3 功能点名称：邀请详情统计**
- 描述：查看具体活动的邀请数据明细
- 输入：活动ID
- 处理逻辑：统计各用户的邀请数据，计算奖励发放情况
- 输出/预期结果：显示邀请人手机号、接受邀请人数、完成邀请人数、奖励明细

#### 模块四：邀请人名单管理模块
**FR4.1 功能点名称：名单导入导出**
- 描述：管理特定身份用户（如代理商）的邀请资格名单
- 输入：Excel文件上传，包含姓名、手机号、身份证号、合同时间等信息
- 处理逻辑：文件格式验证，数据重复性检查，批量数据导入
- 输出/预期结果：名单导入成功，支持模板下载和数据导出

**FR4.2 功能点名称：名单维护管理**
- 描述：对已导入的名单进行增删改查操作
- 输入：用户信息修改、删除操作
- 处理逻辑：数据有效性验证，关联活动检查
- 输出/预期结果：名单维护完成，分页显示管理结果

### 3.2 数据需求 (Data Requirements)

#### 数据实体一：好友邀请活动 (InviteFriendActivity)
- 属性：活动ID、活动名称、活动类型（1级/2级/代理商模式）、开始时间、结束时间、状态、创建时间、页面配置信息、分享配置信息
- 来源：管理员创建活动表单
- 存储：数据库主表，关联多个配置子表

#### 数据实体二：邀请关系 (InviteRelation)
- 属性：邀请关系ID、活动ID、邀请人手机号、被邀请人手机号、邀请时间、接受时间、完成时间、邀请状态、奖励发放状态
- 来源：用户邀请行为产生
- 存储：数据库，用于追踪邀请链路

#### 数据实体三：奖励配置 (RewardConfig)
- 属性：配置ID、活动ID、奖励类型、奖励阶段（接受邀请/完成邀请）、奖励内容、奖励数量、发放条件
- 来源：活动创建时的奖励设置
- 存储：数据库，关联营销券或积分系统

#### 数据实体四：页面配置 (PageConfig)
- 属性：配置ID、活动ID、页面类型（邀请页/被邀请页/接受页）、页面标题、主标语、引导标语、背景图片、banner图片
- 来源：活动创建时的页面设置
- 存储：数据库，图片文件存储在文件系统

#### 数据实体五：邀请人名单 (InviterNameList)
- 属性：记录ID、姓名、手机号、身份证号、合同开始时间、合同结束时间、创建时间、状态
- 来源：Excel批量导入或手动添加
- 存储：数据库，用于验证特殊身份用户的邀请资格

#### 数据实体六：统计数据 (InviteStatistics)
- 属性：统计ID、活动ID、邀请人手机号、接受邀请总数、完成邀请总数、奖励发放记录、统计日期
- 来源：系统定时统计计算
- 存储：数据库，用于快速查询统计数据

## 4. 核心业务流程 (Core Business Flows)

### 流程一：好友邀请活动创建流程
1. 管理员访问创建页面（触发页面渲染功能）
2. 填写活动基础信息（活动名称、时间、类型等）
3. 设置参与资格条件（邀请人和被邀人资格）
4. 配置页面模板（选择模板、上传图片、设置文案）
5. 设置分享内容（分享标题、内容、logo）
6. 配置邀请人奖励规则（接受邀请奖励、完成邀请奖励）
7. 配置被邀人奖励和完成条件
8. 预览活动页面效果
9. 提交创建请求，系统验证并保存活动配置
10. 生成活动链接和二维码，活动创建完成

### 流程二：用户邀请好友流程
1. 邀请人访问活动页面（验证邀请资格）
2. 查看活动详情和奖励规则
3. 选择邀请方式（发送链接/面对面邀请）
4. 生成个人专属邀请链接
5. 通过微信等渠道分享给好友
6. 好友点击链接进入被邀请页面
7. 好友填写手机号接受邀请
8. 系统记录邀请关系，发放接受邀请奖励
9. 通知邀请人好友已接受邀请

### 流程三：完成邀请流程
1. 被邀请人在有效期内执行完成条件
2. 系统监测用户行为（注册/加油等）
3. 满足完成条件时，更新邀请状态
4. 向邀请人发放完成邀请奖励
5. 发送完成通知给相关用户
6. 更新统计数据

### 流程四：活动数据统计分析流程
1. 管理员访问活动列表页面
2. 选择要查看的具体活动
3. 系统查询活动的邀请数据
4. 统计各邀请人的邀请情况
5. 计算奖励发放统计
6. 生成数据报表和图表
7. 支持数据导出功能

## 5. 假设与约束 (Assumptions and Constraints)

### 技术假设
- 使用PHP Blade模板引擎进行页面渲染
- 采用Vue.js框架实现前端交互逻辑
- 使用MySQL数据库存储业务数据
- 集成微信分享SDK实现社交分享功能
- 支持文件上传和图片处理功能

### 功能约束
- 目前支持1级和2级好友邀请模式，最多支持2级邀请关系
- 奖励类型限制为抵用券、积分、积分+经验值、微信红包等
- 邀请链接有效期受活动时间限制
- 被邀请人完成邀请的条件主要为注册和加油消费
- 特殊身份验证（如代理商）需要通过名单管理功能维护

### 数据约束
- 活动名称最大长度15个字符
- 页面标题分为左右两部分，分别限制5个和8个字符
- 分享标题和内容有字数限制
- 图片上传限制格式（bmp、png、jpg、gif）和大小（1M以内）
- 邀请关系链最多支持2级，超出不再记录和奖励

### 业务约束
- 用户只能在有效期内参与邀请活动
- 同一用户在同一活动中只能被邀请一次
- 奖励发放遵循T+1天更新机制
- 代理商模式需要特殊身份认证
- 活动一旦开始，部分核心配置不可修改