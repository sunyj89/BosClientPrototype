# 【数据字典】好友邀请营销系统数据字典v1.0

## 1. 核心业务表

### 1.1 好友邀请活动表 (invite_friend_activity)
| 字段名 | 数据类型 | 长度 | 是否为空 | 默认值 | 主键 | 说明 |
|--------|----------|------|----------|--------|------|------|
| id | INT | 11 | NOT NULL | AUTO_INCREMENT | PK | 活动唯一标识 |
| activity_name | VARCHAR | 100 | NOT NULL | - | - | 活动名称，最大15个字符显示 |
| activity_type | TINYINT | 1 | NOT NULL | 1 | - | 活动类型：1=1级邀请，2=2级邀请，5=代理商模式 |
| start_time | DATETIME | - | NOT NULL | - | - | 活动开始时间 |
| end_time | DATETIME | - | NOT NULL | - | - | 活动结束时间 |
| status | TINYINT | 1 | NOT NULL | 1 | - | 活动状态：1=未开始，2=进行中，3=已结束 |
| activity_url | VARCHAR | 500 | YES | NULL | - | 活动访问链接 |
| activity_code | VARCHAR | 50 | NOT NULL | - | - | 活动编码，用于统计分析 |
| page_title | VARCHAR | 50 | NOT NULL | - | - | 页面标题，格式：左标题|右标题 |
| activity_logo | VARCHAR | 200 | YES | NULL | - | 活动logo图片路径 |
| activity_rule | TEXT | - | YES | NULL | - | 活动规则详细描述 |
| share_title | VARCHAR | 100 | YES | NULL | - | 微信分享标题 |
| share_content | TEXT | - | YES | NULL | - | 微信分享内容 |
| share_logo | VARCHAR | 200 | YES | NULL | - | 微信分享logo图片路径 |
| banner_img | VARCHAR | 200 | YES | NULL | - | 页面banner图片路径 |
| background_img | VARCHAR | 200 | YES | NULL | - | 页面背景图片路径 |
| template_type | TINYINT | 1 | NOT NULL | 1 | - | 页面模板类型 |
| create_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 创建时间 |
| update_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 更新时间 |

### 1.2 邀请关系表 (invite_relation)
| 字段名 | 数据类型 | 长度 | 是否为空 | 默认值 | 主键 | 说明 |
|--------|----------|------|----------|--------|------|------|
| id | BIGINT | 20 | NOT NULL | AUTO_INCREMENT | PK | 邀请关系唯一标识 |
| activity_id | INT | 11 | NOT NULL | - | FK | 关联活动ID |
| inviter_phone | VARCHAR | 20 | NOT NULL | - | - | 邀请人手机号 |
| invitee_phone | VARCHAR | 20 | NOT NULL | - | - | 被邀请人手机号 |
| invite_level | TINYINT | 1 | NOT NULL | 1 | - | 邀请级别：1=1级邀请，2=2级邀请 |
| parent_relation_id | BIGINT | 20 | YES | NULL | FK | 上级邀请关系ID（2级邀请时使用） |
| invite_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 发起邀请时间 |
| accept_time | DATETIME | - | YES | NULL | - | 接受邀请时间 |
| complete_time | DATETIME | - | YES | NULL | - | 完成邀请时间 |
| invite_status | TINYINT | 1 | NOT NULL | 0 | - | 邀请状态：0=已发起，1=已接受，2=已完成，3=已失效 |
| invite_url | VARCHAR | 500 | YES | NULL | - | 个人邀请链接 |
| ip_address | VARCHAR | 50 | YES | NULL | - | 被邀请人IP地址 |
| user_agent | VARCHAR | 500 | YES | NULL | - | 被邀请人浏览器信息 |
| create_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 记录创建时间 |
| update_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 记录更新时间 |

### 1.3 参与资格配置表 (invite_qualification_config)
| 字段名 | 数据类型 | 长度 | 是否为空 | 默认值 | 主键 | 说明 |
|--------|----------|------|----------|--------|------|------|
| id | INT | 11 | NOT NULL | AUTO_INCREMENT | PK | 配置唯一标识 |
| activity_id | INT | 11 | NOT NULL | - | FK | 关联活动ID |
| user_type | TINYINT | 1 | NOT NULL | - | - | 用户类型：1=邀请人，2=被邀请人 |
| qualification_type | TINYINT | 1 | NOT NULL | - | - | 资格类型：1=所有用户，2=加过油用户，11=未注册会员，12=已注册会员，31=认证代理商 |
| is_active | TINYINT | 1 | NOT NULL | 1 | - | 是否启用：0=禁用，1=启用 |
| create_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 创建时间 |

### 1.4 完成邀请条件配置表 (invite_complete_config)
| 字段名 | 数据类型 | 长度 | 是否为空 | 默认值 | 主键 | 说明 |
|--------|----------|------|----------|--------|------|------|
| id | INT | 11 | NOT NULL | AUTO_INCREMENT | PK | 配置唯一标识 |
| activity_id | INT | 11 | NOT NULL | - | FK | 关联活动ID |
| complete_type | TINYINT | 1 | NOT NULL | 1 | - | 完成方式：1=注册即完成，2=加油满足条件 |
| valid_days | INT | 3 | YES | NULL | - | 有效天数（完成方式为2时使用） |
| threshold_config | JSON | - | YES | NULL | - | 加油门槛配置（JSON格式存储） |
| create_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 创建时间 |

## 2. 奖励相关表

### 2.1 奖励配置表 (invite_reward_config)
| 字段名 | 数据类型 | 长度 | 是否为空 | 默认值 | 主键 | 说明 |
|--------|----------|------|----------|--------|------|------|
| id | INT | 11 | NOT NULL | AUTO_INCREMENT | PK | 奖励配置唯一标识 |
| activity_id | INT | 11 | NOT NULL | - | FK | 关联活动ID |
| reward_stage | TINYINT | 1 | NOT NULL | - | - | 奖励阶段：1=接受邀请时，2=完成邀请时 |
| user_type | TINYINT | 1 | NOT NULL | - | - | 用户类型：1=邀请人，2=被邀请人 |
| reward_level | TINYINT | 1 | NOT NULL | 1 | - | 奖励级别：1=1级邀请人，2=2级邀请人 |
| reward_type | TINYINT | 1 | NOT NULL | - | - | 奖励类型：1=抵用券，2=积分，3=积分+经验值，4=微信红包，5=微信红包，7=油品优惠 |
| reward_content | JSON | - | NOT NULL | - | - | 奖励内容详情（JSON格式） |
| reward_amount | DECIMAL | 10,2 | YES | 0.00 | - | 奖励金额或数量 |
| is_active | TINYINT | 1 | NOT NULL | 1 | - | 是否启用：0=禁用，1=启用 |
| create_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 创建时间 |

### 2.2 奖励发放记录表 (invite_reward_record)
| 字段名 | 数据类型 | 长度 | 是否为空 | 默认值 | 主键 | 说明 |
|--------|----------|------|----------|--------|------|------|
| id | BIGINT | 20 | NOT NULL | AUTO_INCREMENT | PK | 发放记录唯一标识 |
| relation_id | BIGINT | 20 | NOT NULL | - | FK | 关联邀请关系ID |
| activity_id | INT | 11 | NOT NULL | - | FK | 关联活动ID |
| user_phone | VARCHAR | 20 | NOT NULL | - | - | 获得奖励的用户手机号 |
| reward_stage | TINYINT | 1 | NOT NULL | - | - | 奖励阶段：1=接受邀请时，2=完成邀请时 |
| reward_type | TINYINT | 1 | NOT NULL | - | - | 奖励类型 |
| reward_content | JSON | - | NOT NULL | - | - | 具体奖励内容 |
| send_status | TINYINT | 1 | NOT NULL | 0 | - | 发放状态：0=待发放，1=发放成功，2=发放失败 |
| send_time | DATETIME | - | YES | NULL | - | 发放时间 |
| fail_reason | VARCHAR | 200 | YES | NULL | - | 发放失败原因 |
| retry_count | TINYINT | 2 | NOT NULL | 0 | - | 重试次数 |
| external_order_no | VARCHAR | 100 | YES | NULL | - | 外部系统订单号 |
| create_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 记录创建时间 |
| update_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 记录更新时间 |

## 3. 页面配置表

### 3.1 页面配置表 (invite_page_config)
| 字段名 | 数据类型 | 长度 | 是否为空 | 默认值 | 主键 | 说明 |
|--------|----------|------|----------|--------|------|------|
| id | INT | 11 | NOT NULL | AUTO_INCREMENT | PK | 页面配置唯一标识 |
| activity_id | INT | 11 | NOT NULL | - | FK | 关联活动ID |
| page_type | TINYINT | 1 | NOT NULL | - | - | 页面类型：1=邀请页面，2=被邀请页面，3=接受邀请页面 |
| page_title | VARCHAR | 100 | NOT NULL | - | - | 页面标题 |
| main_slogan | VARCHAR | 100 | YES | NULL | - | 主标语 |
| guide_slogan | TEXT | - | YES | NULL | - | 引导标语 |
| hint_text | VARCHAR | 200 | YES | NULL | - | 提示语 |
| button_text | VARCHAR | 50 | YES | NULL | - | 按钮文字 |
| create_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 创建时间 |

### 3.2 通知消息配置表 (invite_notification_config)
| 字段名 | 数据类型 | 长度 | 是否为空 | 默认值 | 主键 | 说明 |
|--------|----------|------|----------|--------|------|------|
| id | INT | 11 | NOT NULL | AUTO_INCREMENT | PK | 通知配置唯一标识 |
| activity_id | INT | 11 | NOT NULL | - | FK | 关联活动ID |
| notification_type | TINYINT | 1 | NOT NULL | - | - | 通知类型：1=接受邀请通知，2=完成邀请通知 |
| is_enabled | TINYINT | 1 | NOT NULL | 0 | - | 是否启用通知：0=禁用，1=启用 |
| message_template | TEXT | - | YES | NULL | - | 消息模板内容 |
| variable_config | JSON | - | YES | NULL | - | 变量配置（如手机尾号、油站名称等） |
| create_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 创建时间 |

## 4. 用户管理表

### 4.1 邀请人名单表 (invite_name_list)
| 字段名 | 数据类型 | 长度 | 是否为空 | 默认值 | 主键 | 说明 |
|--------|----------|------|----------|--------|------|------|
| id | INT | 11 | NOT NULL | AUTO_INCREMENT | PK | 名单记录唯一标识 |
| name | VARCHAR | 50 | NOT NULL | - | - | 真实姓名 |
| phone | VARCHAR | 20 | NOT NULL | - | - | 手机号码 |
| id_card | VARCHAR | 25 | NOT NULL | - | - | 身份证号码 |
| contract_start_time | DATE | - | YES | NULL | - | 合同开始时间 |
| contract_end_time | DATE | - | YES | NULL | - | 合同结束时间 |
| status | TINYINT | 1 | NOT NULL | 1 | - | 状态：0=禁用，1=启用 |
| import_batch_id | VARCHAR | 50 | YES | NULL | - | 导入批次ID |
| create_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 创建时间 |
| update_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 更新时间 |

## 5. 统计分析表

### 5.1 邀请统计表 (invite_statistics)
| 字段名 | 数据类型 | 长度 | 是否为空 | 默认值 | 主键 | 说明 |
|--------|----------|------|----------|--------|------|------|
| id | BIGINT | 20 | NOT NULL | AUTO_INCREMENT | PK | 统计记录唯一标识 |
| activity_id | INT | 11 | NOT NULL | - | FK | 关联活动ID |
| inviter_phone | VARCHAR | 20 | NOT NULL | - | - | 邀请人手机号 |
| invite_count | INT | 6 | NOT NULL | 0 | - | 发起邀请总数 |
| accept_count | INT | 6 | NOT NULL | 0 | - | 接受邀请总数 |
| complete_count | INT | 6 | NOT NULL | 0 | - | 完成邀请总数 |
| reward_count | INT | 6 | NOT NULL | 0 | - | 获得奖励总数 |
| total_reward_amount | DECIMAL | 10,2 | NOT NULL | 0.00 | - | 奖励总金额 |
| last_invite_time | DATETIME | - | YES | NULL | - | 最后邀请时间 |
| statistics_date | DATE | - | NOT NULL | - | - | 统计日期 |
| create_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 创建时间 |
| update_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 更新时间 |

### 5.2 日统计表 (invite_daily_statistics)
| 字段名 | 数据类型 | 长度 | 是否为空 | 默认值 | 主键 | 说明 |
|--------|----------|------|----------|--------|------|------|
| id | INT | 11 | NOT NULL | AUTO_INCREMENT | PK | 日统计唯一标识 |
| activity_id | INT | 11 | NOT NULL | - | FK | 关联活动ID |
| statistics_date | DATE | - | NOT NULL | - | - | 统计日期 |
| new_invite_count | INT | 6 | NOT NULL | 0 | - | 新增邀请数 |
| new_accept_count | INT | 6 | NOT NULL | 0 | - | 新增接受数 |
| new_complete_count | INT | 6 | NOT NULL | 0 | - | 新增完成数 |
| total_invite_count | INT | 6 | NOT NULL | 0 | - | 累计邀请数 |
| total_accept_count | INT | 6 | NOT NULL | 0 | - | 累计接受数 |
| total_complete_count | INT | 6 | NOT NULL | 0 | - | 累计完成数 |
| reward_send_count | INT | 6 | NOT NULL | 0 | - | 奖励发放数量 |
| reward_send_amount | DECIMAL | 10,2 | NOT NULL | 0.00 | - | 奖励发放金额 |
| create_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 创建时间 |

## 6. 关联配置表

### 6.1 营销券关联表 (invite_coupon_config)
| 字段名 | 数据类型 | 长度 | 是否为空 | 默认值 | 主键 | 说明 |
|--------|----------|------|----------|--------|------|------|
| id | INT | 11 | NOT NULL | AUTO_INCREMENT | PK | 关联配置唯一标识 |
| reward_config_id | INT | 11 | NOT NULL | - | FK | 关联奖励配置ID |
| coupon_id | INT | 11 | NOT NULL | - | FK | 营销券ID |
| coupon_count | INT | 4 | NOT NULL | 1 | - | 营销券数量 |
| coupon_name | VARCHAR | 100 | NOT NULL | - | - | 营销券名称 |
| coupon_amount | DECIMAL | 8,2 | NOT NULL | 0.00 | - | 营销券面额 |
| coupon_type | TINYINT | 1 | NOT NULL | - | - | 营销券类型 |
| create_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 创建时间 |

### 6.2 微信红包配置表 (invite_wechat_redpacket_config)
| 字段名 | 数据类型 | 长度 | 是否为空 | 默认值 | 主键 | 说明 |
|--------|----------|------|----------|--------|------|------|
| id | INT | 11 | NOT NULL | AUTO_INCREMENT | PK | 红包配置唯一标识 |
| reward_config_id | INT | 11 | NOT NULL | - | FK | 关联奖励配置ID |
| redpacket_id | INT | 11 | NOT NULL | - | FK | 微信红包活动ID |
| redpacket_name | VARCHAR | 100 | NOT NULL | - | - | 红包名称 |
| min_amount | DECIMAL | 8,2 | NOT NULL | 0.00 | - | 最小金额 |
| max_amount | DECIMAL | 8,2 | NOT NULL | 0.00 | - | 最大金额 |
| total_count | INT | 8 | NOT NULL | 0 | - | 红包总数量 |
| remaining_count | INT | 8 | NOT NULL | 0 | - | 剩余数量 |
| create_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 创建时间 |

## 7. 系统日志表

### 7.1 操作日志表 (invite_operation_log)
| 字段名 | 数据类型 | 长度 | 是否为空 | 默认值 | 主键 | 说明 |
|--------|----------|------|----------|--------|------|------|
| id | BIGINT | 20 | NOT NULL | AUTO_INCREMENT | PK | 日志唯一标识 |
| activity_id | INT | 11 | YES | NULL | FK | 关联活动ID |
| operation_type | VARCHAR | 50 | NOT NULL | - | - | 操作类型（create、update、delete等） |
| operation_user | VARCHAR | 50 | NOT NULL | - | - | 操作用户 |
| operation_details | JSON | - | YES | NULL | - | 操作详情 |
| ip_address | VARCHAR | 50 | YES | NULL | - | 操作IP地址 |
| user_agent | VARCHAR | 500 | YES | NULL | - | 浏览器信息 |
| operation_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 操作时间 |

### 7.2 异常日志表 (invite_error_log)
| 字段名 | 数据类型 | 长度 | 是否为空 | 默认值 | 主键 | 说明 |
|--------|----------|------|----------|--------|------|------|
| id | BIGINT | 20 | NOT NULL | AUTO_INCREMENT | PK | 异常日志唯一标识 |
| activity_id | INT | 11 | YES | NULL | FK | 关联活动ID |
| error_type | VARCHAR | 50 | NOT NULL | - | - | 异常类型 |
| error_message | TEXT | - | NOT NULL | - | - | 异常信息 |
| error_stack | TEXT | - | YES | NULL | - | 异常堆栈 |
| request_data | JSON | - | YES | NULL | - | 请求数据 |
| user_phone | VARCHAR | 20 | YES | NULL | - | 相关用户手机号 |
| ip_address | VARCHAR | 50 | YES | NULL | - | 请求IP地址 |
| create_time | DATETIME | - | NOT NULL | CURRENT_TIMESTAMP | - | 异常发生时间 |

## 8. 数据约束说明

### 8.1 主键约束
- 所有表均采用自增主键ID作为唯一标识
- 主键字段统一命名为`id`
- 业务表主键使用INT类型，日志表使用BIGINT类型

### 8.2 外键约束
- `activity_id`字段关联`invite_friend_activity`表的主键
- `relation_id`字段关联`invite_relation`表的主键
- `reward_config_id`字段关联`invite_reward_config`表的主键

### 8.3 唯一性约束
- 活动表的`activity_code`字段需要保证唯一性
- 邀请关系表的`activity_id + inviter_phone + invitee_phone`组合唯一
- 邀请人名单表的`phone`字段需要保证唯一性

### 8.4 索引建议
- 为`activity_id`字段建立普通索引（高频查询字段）
- 为`inviter_phone`和`invitee_phone`字段建立普通索引
- 为`create_time`字段建立普通索引（用于时间范围查询）
- 为`statistics_date`字段建立普通索引（统计查询优化）

### 8.5 数据类型说明
- 手机号统一使用VARCHAR(20)存储
- 金额字段统一使用DECIMAL(10,2)存储，保证精度
- 时间字段统一使用DATETIME类型
- JSON配置字段使用JSON类型存储复杂配置信息
- 状态字段统一使用TINYINT(1)存储