# 商业需求文档 (BRD) - 油品主数据管理系统

## 1. 模块概述 (Project Overview)

### 1.1 模块目标与价值 (Project Goals and Value Proposition)
* **主要目标：** 建立统一的油品主数据管理平台，实现油品信息的标准化管理、分类体系维护和变更记录追踪，为智慧能源系统提供准确可靠的基础数据支撑。
* **核心价值：** 
  - 提升油品数据管理效率和准确性
  - 建立标准化的油品分类体系
  - 实现数据变更的全流程追踪和审批控制
  - 为下游业务系统提供统一的油品基础数据

### 1.2 模块范围 (Project Scope)
* **核心功能模块：** 
  - 油品信息管理模块：油品基础信息的增删改查
  - 油品分类管理模块：层次化分类体系维护
  - 修改记录模块：操作历史追踪和审批管理
  - 表单处理模块：统一的数据录入和编辑界面
* **本次迭代：** 基于当前代码逻辑的完整功能范围v1.0版本

## 2. 用户分析 (User Analysis)

### 2.1 用户场景 (User Scenarios)
* **场景1：油品信息录入**
  - 业务人员需要新增一种油品时，通过油品列表页面点击"新建油品"按钮，填写油品编号、线上油品编号、分类、名称、简称、类型、排放等级、密度等信息，提交后进入审批流程。
* **场景2：油品分类维护**
  - 管理员需要调整油品分类体系时，通过分类管理页面的树形结构，可以添加、编辑、删除分类节点，支持最多4级分类层次。
* **场景3：数据变更追踪**
  - 质量管理人员需要查看油品数据变更历史时，通过修改记录页面可以查看所有操作记录，包括操作类型、操作人、时间、审批状态等信息。

## 3. 产品需求 (Product Requirements)

### 3.1 功能需求 (Functional Requirements)

* **模块一：油品信息管理模块**
  * **FR1.1 功能点名称：** 油品信息新建
    * **描述：** 用户可以通过表单创建新的油品记录，包括完整的油品属性信息。
    * **输入：** 油品编号、线上油品编号、分类、名称、简称、类型、排放等级、默认密度
    * **处理逻辑：** 前端表单验证 → 数据提交 → 后端校验 → 创建记录 → 进入审批流程
    * **输出/预期结果：** 创建成功提示，记录状态为"审批中"，生成操作记录

  * **FR1.2 功能点名称：** 油品信息编辑
    * **描述：** 对**未生效、生效中**状态的油品记录进行修改。
    * **输入：** 修改后的油品属性信息
    * **处理逻辑：** 状态检查 → 表单预填充 → 数据修改 → 提交审批
    * **输出/预期结果：** 编辑成功提示，记录状态更新为"审批中"

  * **FR1.3 功能点名称：** 油品信息查看
    * **描述：** 查看油品的详细信息，支持只读模式显示。
    * **输入：** 油品记录选择
    * **处理逻辑：** 数据查询 → 表单只读渲染
    * **输出/预期结果：** 显示完整的油品信息详情

  * **FR1.4 功能点名称：** 油品信息删除
    * **描述：** 删除未生效状态的油品记录。
    * **输入：** 删除确认操作
    * **处理逻辑：** 状态检查 → 删除确认 → 提交删除申请
    * **输出/预期结果：** 删除申请提交，等待审批

  * **FR1.5 功能点名称：** 油品信息查询
    * **描述：** 支持多条件组合查询油品信息。
    * **输入：** 油品编号、线上油品编号、名称、分类、类型、排放等级、状态
    * **处理逻辑：** 条件组合 → 数据过滤 → 结果展示
    * **输出/预期结果：** 符合条件的油品列表

* **模块二：油品分类管理模块**
  * **FR2.1 功能点名称：** 分类树形展示
    * **描述：** 以树形结构展示油品分类层次，支持展开/收起操作。
    * **输入：** 页面加载请求
    * **处理逻辑：** 数据查询 → 树形结构构建 → 渲染展示
    * **输出/预期结果：** 层次化的分类树形界面

  * **FR2.2 功能点名称：** 分类新增
    * **描述：** 在指定父分类下新增子分类。
    * **输入：** 分类名称、父分类ID、排序号、描述信息
    * **处理逻辑：** 层级验证 → 数据保存 → 树形结构更新
    * **输出/预期结果：** 新分类节点添加到树形结构

  * **FR2.3 功能点名称：** 分类编辑
    * **描述：** 修改分类的基础信息。
    * **输入：** 修改后的分类信息
    * **处理逻辑：** 数据验证 → 信息更新 → 界面刷新
    * **输出/预期结果：** 分类信息更新成功

  * **FR2.4 功能点名称：** 分类搜索
    * **描述：** 在分类树中搜索指定关键词的分类。
    * **输入：** 搜索关键词
    * **处理逻辑：** 关键词匹配 → 结果高亮 → 自动展开
    * **输出/预期结果：** 匹配的分类节点高亮显示

* **模块三：修改记录模块**
  * **FR3.1 功能点名称：** 操作记录展示
    * **描述：** 显示所有油品相关的操作记录列表。
    * **输入：** 页面查询请求
    * **处理逻辑：** 记录查询 → 数据格式化 → 列表展示
    * **输出/预期结果：** 按时间倒序的操作记录列表

  * **FR3.2 功能点名称：** 记录详情查看
    * **描述：** 查看单条操作记录的详细信息，包括变更内容对比。
    * **输入：** 记录ID选择
    * **处理逻辑：** 详情查询 → 变更对比 → 弹窗展示
    * **输出/预期结果：** 显示操作详情和字段变更对比

  * **FR3.3 功能点名称：** 记录筛选
    * **描述：** 根据多种条件筛选操作记录。
    * **输入：** 油品名称、操作类型、审批状态、操作人、操作时间范围
    * **处理逻辑：** 条件组合 → 数据过滤 → 结果更新
    * **输出/预期结果：** 符合条件的记录列表

### 3.2 数据需求 (Data Requirements)

* **数据实体一：** 油品信息 (OilProduct)
  * **属性：** 油品ID, 油品编号, 线上油品编号, 油品名称, 油品简称, 分类ID, 分类名称, 分类路径, 油品类型, 排放等级, 默认密度, 状态, 创建时间, 更新时间, 审批人
  * **来源：** 用户表单录入
  * **存储：** 数据库主表

* **数据实体二：** 油品分类 (OilCategory)
  * **属性：** 分类ID, 分类编码, 分类名称, 父分类ID, 层级, 排序号, 状态, 描述, 创建时间, 更新时间
  * **来源：** 管理员配置
  * **存储：** 数据库分类表

* **数据实体三：** 修改记录 (ModifyRecord)
  * **属性：** 记录ID, 油品编号, 油品名称, 操作类型, 操作人, 操作时间, 审批状态, 变更字段列表, 变更原因
  * **来源：** 系统自动记录
  * **存储：** 数据库日志表

* **数据实体四：** 变更字段详情 (ChangeField)
  * **属性：** 字段名称, 原值, 新值
  * **来源：** 系统对比生成
  * **存储：** 嵌套在修改记录中

## 4. 假设与约束 (Assumptions and Constraints)

* **技术假设：** 
  - 基于React + Ant Design技术栈开发
  - 支持现代浏览器环境
  - 后端提供RESTful API接口
  - 数据存储采用关系型数据库

* **功能约束：** 
  - 分类层级最多支持4级
  - 油品编号必须以"10"开头的6位数字
  - 生效中和审批中的记录不允许编辑和删除
  - 天然气和尿素类型不需要排放等级

* **数据约束：** 
  - 油品编号全局唯一
  - 线上油品编号必填
  - 密度范围限制在0.5-1.0之间
  - 分类名称在同级别下不能重复

---

**文档版本：** v1.1  
**创建日期：** 2025年7月4日  
**最后更新：** 2025年7月10日 