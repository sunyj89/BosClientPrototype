# 商业需求文档 (BRD) - 设备管理系统

**文档版本：** v1.0  
**创建日期：** 2025年7月21日  
**创建人：** 孙杨竣@喂车

## 1. 模块概述 (Project Overview)

### 1.1 模块目标与价值 (Project Goals and Value Proposition)
* **主要目标：** 提供一个全面的加油站设备管理平台，实现设备档案信息化管理、设备运行状态实时监控、设备维护校验记录管理，提升设备管理效率和数据准确性。
* **核心价值：** 
  - 统一管理加油站所有设备档案信息，建立完整的设备资产清单
  - 实时监控液位仪等关键设备运行状态，及时发现设备异常
  - 规范化设备校验和维护流程，确保设备安全稳定运行
  - 数字化水电表管理，为运营成本核算提供准确数据支撑

### 1.2 模块范围 (Project Scope)
* **核心功能模块：** 
  - 设备档案管理模块
  - 液位仪管理模块  
  - 加油机校验记录模块
  - 发电机运行记录模块
  - 水电表记录模块
* **本次迭代：** 基于当前代码逻辑的完整功能范围，涵盖设备全生命周期管理

## 2. 用户分析 (User Analysis)

### 2.1 用户场景 (User Scenarios)
* **设备管理员场景：** 管理员需要查看某个加油站的设备清单时，通过设备档案管理页面，可以按照油站筛选设备，查看设备的基本信息、使用状态、责任人等详细信息，并能够新增、编辑或删除设备档案。
* **运维人员场景：** 运维人员需要监控液位仪运行状态时，通过液位仪管理页面的实时监控功能，可以查看所有液位仪的在线状态、告警信息，点击具体设备可查看详细的油罐状态、历史数据图表和告警处理记录。
* **质检人员场景：** 质检人员需要记录加油机校验结果时，通过校验记录页面创建新的校验记录，录入校验数据如标准体积、示值误差等，系统自动计算校验结果并判定是否合格。
* **站长场景：** 站长需要查看发电机运行情况时，通过发电机运行记录页面查看运行原因、运行时间、油耗等信息，并对运行记录进行审批。

## 3. 产品需求 (Product Requirements)

### 3.1 功能需求 (Functional Requirements)

* **模块一：设备档案管理模块**
  * **FR1.1 功能点名称：** 设备档案信息管理
    * **描述：** 用户可以对设备档案进行增删改查操作，管理设备的基本信息
    * **输入：** 设备编号、设备名称、设备型号、使用性质、所属油站、出厂编号、购置时间、生产厂家、使用状态、责任人
    * **处理逻辑：** 表单验证、数据保存到equipmentArchiveData、生成修改记录
    * **输出/预期结果：** 设备档案成功保存，列表页面更新，生成操作记录

  * **FR1.2 功能点名称：** 设备档案筛选查询
    * **描述：** 支持按多个维度筛选和搜索设备档案
    * **输入：** 搜索关键词、设备状态、所属油站、使用性质
    * **处理逻辑：** 根据筛选条件过滤设备列表数据
    * **输出/预期结果：** 返回符合条件的设备列表

  * **FR1.3 功能点名称：** 修改记录管理
    * **描述：** 记录设备档案的所有变更历史，支持查看修改详情
    * **输入：** 操作类型、操作人、操作时间、变更内容
    * **处理逻辑：** 自动记录设备档案的增删改操作
    * **输出/预期结果：** 生成修改记录，可供查询追溯

* **模块二：液位仪管理模块**
  * **FR2.1 功能点名称：** 设备状态监控
    * **描述：** 实时显示液位仪设备的运行状态和统计信息
    * **输入：** 组织筛选、设备状态筛选、报警状态筛选、搜索关键词
    * **处理逻辑：** 从DeviceData获取设备数据，按条件筛选，统计在线/离线/报警设备数量
    * **输出/预期结果：** 显示设备列表、统计卡片、报警提示

  * **FR2.2 功能点名称：** 设备详情监控
    * **描述：** 查看单个液位仪设备的详细信息和实时数据
    * **输入：** 设备ID
    * **处理逻辑：** 根据设备ID生成模拟设备数据，包括油罐状态、历史趋势、告警记录
    * **输出/预期结果：** 设备基本信息、油罐状态图表、告警历史、维护记录

  * **FR2.3 功能点名称：** 告警处理
    * **描述：** 处理设备告警信息，记录处理结果
    * **输入：** 告警ID、处理方式、处理结果
    * **处理逻辑：** 更新告警状态，记录处理信息
    * **输出/预期结果：** 告警状态更新，生成处理记录

* **模块三：加油机校验记录模块**
  * **FR3.1 功能点名称：** 校验记录管理
    * **描述：** 创建、查看、编辑加油机校验记录
    * **输入：** 校验单编号、加油枪编号、油品名称、校验原因、标准容积、校验升数、量器读数
    * **处理逻辑：** 自动计算标准体积、示值误差、平均示值误差、重复性误差，判定校验结果
    * **输出/预期结果：** 校验记录保存，校验结果计算完成

  * **FR3.2 功能点名称：** 校验数据导出
    * **描述：** 根据筛选条件导出校验记录数据
    * **输入：** 筛选条件（油站、油品、状态等）
    * **处理逻辑：** 筛选数据并格式化为导出格式
    * **输出/预期结果：** 生成Excel格式的校验记录报表

* **模块四：发电机运行记录模块**
  * **FR4.1 功能点名称：** 运行记录管理
    * **描述：** 记录发电机的运行情况和维护信息
    * **输入：** 记录编号、所属油站、运行原因、运行时间、运行状态、油耗、累计运行时间
    * **处理逻辑：** 验证数据完整性，保存运行记录，更新设备状态
    * **输出/预期结果：** 运行记录保存成功，状态更新

  * **FR4.2 功能点名称：** 审批流程
    * **描述：** 对运行记录进行审批管理
    * **输入：** 记录ID、审批意见、审批结果
    * **处理逻辑：** 更新记录状态，记录审批信息
    * **输出/预期结果：** 审批状态更新，通知相关人员

* **模块五：水电表记录模块**
  * **FR5.1 功能点名称：** 交接明细管理
    * **描述：** 记录班次间水电表的交接数据
    * **输入：** 记录编号、油站、班次、水表/电表读数、交接人员
    * **处理逻辑：** 自动计算走字数和总度数，验证数据合理性
    * **输出/预期结果：** 交接记录保存，自动计算消耗量

  * **FR5.2 功能点名称：** 月报表生成
    * **描述：** 基于交接明细自动生成月度统计报表
    * **输入：** 查询月份、油站选择
    * **处理逻辑：** 汇总月度交接数据，计算期初期末数、总度数、吨油耗用量
    * **输出/预期结果：** 生成月度水电表统计报表

### 3.2 数据需求 (Data Requirements)

* **数据实体一：设备档案 (EquipmentArchive)**
  * **属性：** 设备ID、设备编号、设备名称、设备型号、使用性质、所属油站ID、油站名称、出厂编号、购置日期、生产厂家、使用状态、责任人、创建时间、更新时间
  * **来源：** 设备档案管理表单
  * **存储：** 数据表
* **数据实体二：液位仪设备 (LiquidLevelDevice)**
  * **属性：** 设备ID、设备名称、设备类型、所属油站、安装位置、设备状态、报警状态、最后活跃时间、设备型号、制造商、安装日期、维护次数、故障次数
  * **来源：** 设备监控系统实时数据
  * **存储：** 数据表
* **数据实体三：校验记录 (ValidationRecord)**
  * **属性：** 校验ID、校验单编号、加油枪ID、加油枪编码、油站ID、油品类型、校验原因、标准容积、校验体积、量器读数、标准体积、示值误差、校验结果、校验日期、校验人、状态、审批意见
  * **来源：** 校验记录表单
  * **存储：** 数据表
* **数据实体四：发电机运行记录 (GeneratorRecord)**
  * **属性：** 记录ID、记录编号、油站ID、运行原因、开始时间、结束时间、运行状态、油耗、累计运行时间、状态、审批意见、创建人、站长、备注
  * **来源：** 发电机运行记录表单
  * **存储：** 数据表
* **数据实体五：水电表交接记录 (WaterElectricityRecord)**
  * **属性：** 记录ID、记录编号、油站ID、班次、水表1/2读数、电表1/2读数、总水/电消耗、交班人、接班人、创建人、备注、创建时间
  * **来源：** 水电表交接表单
  * **存储：** 数据表

## 4. 核心业务流程 (Core Business Flows)

* **流程一：设备档案管理流程**
  1. 用户访问设备档案管理页面
  2. 系统加载设备档案列表数据
  3. 用户可进行筛选、搜索操作
  4. 用户点击新增/编辑按钮
  5. 系统打开设备档案表单
  6. 用户填写设备信息并提交
  7. 系统验证数据完整性和格式
  8. 保存设备档案到数据存储
  9. 生成修改记录
  10. 返回操作结果并刷新列表

* **流程二：液位仪设备监控流程**
  1. 用户访问液位仪管理页面
  2. 系统加载设备状态数据
  3. 系统计算并显示统计信息
  4. 如有告警设备，显示告警提示
  5. 用户可筛选和搜索设备
  6. 用户点击设备名称查看详情
  7. 系统生成设备详细数据
  8. 显示油罐状态、历史图表
  9. 用户可处理告警或登记维护

* **流程三：校验记录管理流程**
  1. 用户访问校验记录页面
  2. 用户点击创建校验记录
  3. 选择加油枪和油品信息
  4. 填写校验原始数据
  5. 系统自动计算校验结果
  6. 判定校验是否合格
  7. 保存校验记录
  8. 更新记录状态为待审批
  9. 审批人员审核校验记录
  10. 完成审批流程

* **流程四：发电机运行记录流程**
  1. 操作人员访问发电机运行记录页面
  2. 创建新的运行记录
  3. 填写运行原因、时间、状态等信息
  4. 提交运行记录
  5. 系统保存记录并设为待审批状态
  6. 站长查看并审批记录
  7. 更新记录状态和审批意见
  8. 生成最终的运行记录

* **流程五：水电表记录管理流程**
  1. 交班人员访问水电表交接页面
  2. 选择油站和班次
  3. 录入水表、电表的交班读数
  4. 系统自动计算走字数
  5. 接班人员确认并签字
  6. 保存交接记录
  7. 系统定期生成月度报表
  8. 汇总月度用水用电数据
  9. 计算吨油耗用量指标

## 5. 假设与约束 (Assumptions and Constraints)

* **技术假设：** 
  - 基于React + Ant Design框架开发
  - 使用JSON文件作为模拟数据存储
  - 支持主流浏览器访问
  - 具备响应式设计能力

* **功能约束：** 
  - 目前为模拟数据环境，未连接真实数据库
  - 液位仪监控数据为模拟生成，非真实设备数据
  - 审批流程相对简化，未实现复杂的多级审批
  - 报表导出功能暂未实现真实文件下载

* **数据约束：** 
  - 设备编号必须全局唯一
  - 必填字段不能为空
  - 日期时间格式需符合标准
  - 数值字段需在合理范围内
  - 关联数据需保持一致性

* **业务约束：**
  - 符合加油站设备管理规范
  - 校验记录需符合计量法规要求
  - 需要相应的操作权限控制
  - 重要操作需要审批确认 
