# 商业需求文档 (BRD) - 组织结构和角色设计模块

**文档版本：** v1.0  
**创建日期：** 2025年7月8日  
**文档类型：** 商业需求文档  

## 1. 模块概述 (Project Overview)

### 1.1 模块目标与价值 (Project Goals and Value Proposition)
* **主要目标：** 提供一个完整的组织架构管理和角色权限配置系统，支持多层级组织结构的创建、维护和人员管理，实现企业组织架构的数字化管理。
* **核心价值：** 
  - 提升组织架构管理效率，支持集团总部、分公司、部门、服务区、加油站等多种组织类型
  - 实现人员与组织的清晰关联，提供角色权限的精细化管理
  - 支持法人主体管理，满足多法人企业的组织架构需求

### 1.2 模块范围 (Project Scope)
* **核心功能模块：** 
  - 组织架构管理模块
  - 人员管理模块
  - 角色配置模块
  - 权限管理模块
* **本次迭代：** 基于当前代码逻辑的完整功能范围v1.0版本

## 2. 用户分析 (User Analysis)

### 2.1 用户场景 (User Scenarios)
* **场景1：组织架构管理员创建新的分公司**
  - 管理员选择集团总部节点，点击"新增子组织"按钮
  - 在弹出的组织配置对话框中填写分公司信息（名称、类型、法人主体等）
  - 系统生成10位数字组织ID，将新分公司添加到组织树中
  - 管理员可查看新创建分公司的详细信息

* **场景2：人事管理员为员工分配角色**
  - 管理员在组织树中选择特定组织单元
  - 查看该组织下的员工列表，点击"添加用户"或"编辑"按钮
  - 为用户填写基本信息并从角色列表中选择合适的岗位角色
  - 系统自动生成12位数字员工ID并完成用户角色关联

* **场景3：权限管理员配置新角色**
  - 管理员进入角色配置模块，查看现有角色配置列表
  - 创建新角色或复制现有角色，配置角色名称和描述
  - 为角色分配相应的权限组合，保存角色配置
  - 新角色可立即用于用户分配

## 3. 产品需求 (Product Requirements)

### 3.1 功能需求 (Functional Requirements)

#### **模块一：组织架构管理模块**
* **FR1.1 组织树展示**
  * **描述：** 以树形结构展示完整的组织架构，支持图标区分不同组织类型
  * **输入：** 无（自动加载）
  * **处理逻辑：** 从后端API获取组织树数据，递归渲染树形结构，根据组织类型显示对应图标
  * **输出/预期结果：** 可交互的组织架构树，支持节点选择和展开/收起

* **FR1.2 组织单元增加**
  * **描述：** 支持在现有组织节点下新增子组织
  * **输入：** 组织名称、组织类型、法人主体、上级组织
  * **处理逻辑：** 验证输入数据，生成10位数字组织ID，调用API创建组织单元
  * **输出/预期结果：** 新组织添加到组织树中，显示成功提示

* **FR1.3 组织单元编辑**
  * **描述：** 修改现有组织单元的基本信息
  * **输入：** 修改后的组织名称、类型、法人主体等信息
  * **处理逻辑：** 表单验证，调用更新API保存修改
  * **输出/预期结果：** 组织信息更新，树结构刷新

* **FR1.4 组织单元删除**
  * **描述：** 删除组织单元及其下属的所有子组织和员工
  * **输入：** 待删除的组织单元ID
  * **处理逻辑：** 二次确认，检查是否有子组织和员工，执行级联删除
  * **输出/预期结果：** 组织及相关数据被删除，组织树更新

#### **模块二：人员管理模块**
* **FR2.1 用户列表展示**
  * **描述：** 显示所选组织单元下的所有员工信息
  * **输入：** 选中的组织节点ID
  * **处理逻辑：** 根据组织ID筛选用户列表，分页展示
  * **输出/预期结果：** 表格形式展示员工列表，包含ID、姓名、角色等信息

* **FR2.2 用户新增**
  * **描述：** 在指定组织下添加新员工
  * **输入：** 姓名、角色ID、所属组织ID
  * **处理逻辑：** 表单验证，生成12位数字员工ID，调用API创建用户
  * **输出/预期结果：** 新用户添加到组织中，用户列表刷新

* **FR2.3 用户编辑**
  * **描述：** 修改现有员工的基本信息和角色分配
  * **输入：** 修改后的用户信息和角色
  * **处理逻辑：** 表单验证，调用更新API保存修改
  * **输出/预期结果：** 用户信息更新成功

* **FR2.4 用户删除**
  * **描述：** 从组织中删除员工
  * **输入：** 用户ID
  * **处理逻辑：** 二次确认，调用删除API
  * **输出/预期结果：** 用户被删除，列表更新

#### **模块三：角色配置模块**
* **FR3.1 角色列表管理**
  * **描述：** 展示和管理系统中所有角色配置
  * **输入：** 无（自动加载）
  * **处理逻辑：** 获取角色配置列表，分页展示
  * **输出/预期结果：** 表格形式展示角色配置信息

* **FR3.2 角色新增**
  * **描述：** 创建新的角色配置
  * **输入：** 角色名称、描述、权限配置
  * **处理逻辑：** 表单验证，权限配置，调用API创建角色
  * **输出/预期结果：** 新角色配置创建成功

* **FR3.3 角色编辑**
  * **描述：** 修改现有角色的配置信息
  * **输入：** 修改后的角色信息和权限
  * **处理逻辑：** 表单验证，权限更新，调用API保存
  * **输出/预期结果：** 角色配置更新成功

* **FR3.4 角色复制**
  * **描述：** 基于现有角色创建副本，便于快速配置相似角色
  * **输入：** 源角色ID、新角色名称、描述
  * **处理逻辑：** 复制源角色的权限配置，创建新角色
  * **输出/预期结果：** 新角色配置创建成功

* **FR3.5 角色删除**
  * **描述：** 删除不再需要的角色配置（系统角色不可删除）
  * **输入：** 角色ID
  * **处理逻辑：** 检查是否为系统角色，二次确认，调用删除API
  * **输出/预期结果：** 角色配置被删除

### 3.2 数据需求 (Data Requirements)

#### **数据实体一：组织单元 (OrgUnit)**
* **属性：** 
  - id: 10位数字组织ID
  - name: 组织名称
  - orgType: 组织类型（HEADQUARTER/CITY_BRANCH/DEPARTMENT/SERVICE_AREA/GAS_STATION）
  - parentId: 上级组织ID
  - parentName: 上级组织名称
  - legalEntity: 法人主体信息
  - children: 子组织列表
* **来源：** 组织管理表单输入
* **存储：** 数据库（当前为模拟数据）

#### **数据实体二：用户 (User)**
* **属性：** 
  - id: 12位数字员工ID
  - name: 用户姓名
  - orgUnitId: 所属组织ID
  - role: 角色信息对象
  - createTime: 创建时间
  - updateTime: 更新时间
* **来源：** 用户管理表单输入
* **存储：** 数据库（当前为模拟数据）

#### **数据实体三：角色 (Role)**
* **属性：** 
  - id: 角色ID
  - name: 角色名称
  - roleName: 角色配置名称
  - description: 角色描述
  - isSystemRole: 是否系统角色
  - permissions: 权限配置
* **来源：** 角色配置表单输入
* **存储：** 数据库（当前为模拟数据）

#### **数据实体四：法人主体 (LegalEntity)**
* **属性：** 
  - id: 法人主体ID
  - name: 法人主体名称
* **来源：** 系统预配置或管理员配置
* **存储：** 数据库（当前为模拟数据）

#### **数据实体五：权限 (Permission)**
* **属性：** 
  - id: 权限ID
  - name: 权限名称
  - code: 权限代码
  - description: 权限描述
  - category: 权限分类
* **来源：** 系统预定义权限集
* **存储：** 数据库（当前为模拟数据）

## 4. 核心业务流程 (Core Business Flows)

### **流程一：组织架构创建流程**
1. 管理员进入组织架构管理页面 (访问 `/organization` 路由)
2. 系统加载组织树数据 (调用 `getOrgTree` API)
3. 管理员选择要添加子组织的父节点
4. 点击"新增子组织"按钮 (触发 `handleAddOrg` 函数)
5. 打开组织配置弹窗 (显示 `AddOrgModal` 组件)
6. 填写组织信息并提交 (调用 `addOrgUnit` API)
7. 生成10位数字组织ID，保存组织数据
8. 刷新组织树显示新组织 (重新调用 `loadTreeData`)

### **流程二：用户角色分配流程**
1. 管理员在组织树中选择目标组织节点 (触发 `handleNodeSelect` 函数)
2. 系统加载该组织下的用户列表 (调用 `getUsersByOrgId` API)
3. 管理员点击"添加用户"或"编辑用户"按钮
4. 打开用户信息弹窗，填写用户信息和选择角色
5. 表单验证通过后提交数据 (调用 `addUser` 或 `updateUser` API)
6. 生成12位数字员工ID（新增时），关联用户与角色
7. 刷新用户列表显示更新结果

## 5. 假设与约束 (Assumptions and Constraints)

### **技术假设：**
- 基于React框架开发，使用Ant Design UI组件库
- 使用模拟数据进行开发，未连接真实后端API
- 采用前端路由管理页面跳转
- 使用函数组件和Hooks管理状态

### **功能约束：**
- 当前为模拟数据实现，所有操作结果不会持久化
- 组织ID为10位数字，员工ID为12位数字
- 根组织节点不能被删除
- 系统角色不允许删除
- 删除组织会级联删除所有子组织和员工

### **数据约束：**
- 组织名称为必填项
- 用户姓名为必填项
- 角色分配为必填项
- 组织类型限定为5种预定义类型
- 法人主体需要预先配置

---

**文档状态：** 已完成  
**审核人：** 待定  
**批准人：** 待定 