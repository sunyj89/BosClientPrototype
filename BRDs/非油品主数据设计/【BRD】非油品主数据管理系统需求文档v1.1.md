# 商业需求文档 (BRD) - 非油品主数据管理系统

## 1. 需求概述 (Project Overview)

### 1.1 需求背景与痛点 (Background and Pain Points)
* **业务背景：** 随着零售业务的快速发展，非油品商品种类日益增多，传统的手工管理方式已无法满足业务需求，亟需一套完整的非油品主数据管理系统。
* **核心痛点：**
  - 商品数据分散，缺乏统一管理平台
  - 价格变更频繁，历史记录追溯困难
  - 库存信息不及时，影响采购决策
  - 分类体系不规范，商品查找效率低
  - 组合商品定价复杂，营销策略执行困难

### 1.2 需求目标与价值 (Project Goals and Value Proposition)
* **主要目标：** 构建一套完整的非油品主数据管理系统，实现商品信息的统一管理、价格策略的灵活制定、库存信息的实时监控和采购流程的标准化。
* **核心价值：**
  - 提升商品数据管理效率，减少人工错误
  - 实现价格策略的精细化管理，提升盈利能力
  - 建立完善的库存预警机制，优化资金使用
  - 规范采购流程，提高供应链管理水平
  - 支持组合商品营销，增强市场竞争力

### 1.3 需求范围 (Project Scope)
* **核心功能模块：**
  - 商品主数据管理模块
  - 商品分类管理模块
  - 组合商品管理模块
  - 审批流程管理模块
  - 变更记录管理模块
* **本次迭代：** 基于当前代码逻辑的完整功能范围，重点关注非油品商品主数据管理和审批流程控制

## 2. 用户分析 (User Analysis)

### 2.1 目标用户群体 (Target Audience)
* **商品管理员：** 负责商品基础信息维护、分类管理、组合商品配置
* **审批人员：** 负责商品相关操作的审核和审批
* **门店经理：** 查看商品信息、监控经营数据
* **系统管理员：** 负责系统配置、权限管理、数据维护

### 2.2 用户场景 (User Scenarios)
* **商品新增场景：** 商品管理员需要录入新商品信息，包括基本属性、分类归属等，通过商品维护界面完成商品创建、提交审批、等待审核的完整流程。
* **商品审批场景：** 审批人员需要对商品管理员提交的商品新增、修改、上下架申请进行审核，查看申请详情、审批数据变更，给出审批意见并确认通过或拒绝。
* **分类管理场景：** 商品管理员需要维护商品分类体系，创建新分类或调整分类结构，重要变更需要提交审批流程。
* **组合商品配置场景：** 商品管理员创建组合商品套餐，选择包含的单品和数量，设置组合价格，提交审批后生效。

## 3. 产品需求 (Product Requirements)

### 3.1 功能需求 (Functional Requirements)

#### **模块一：商品主数据管理模块**

* **FR1.1 商品维护功能**
  * **描述：** 提供商品基础信息的增删改查功能，支持商品生命周期管理
  * **输入：** SKU编码、商品名称、规格、条形码、分类、单位、重量、体积、默认销售价格等
  * **处理逻辑：** 
    - 系统自动生成SKU编码
    - 验证条形码唯一性
    - 支持商品状态流转（草稿→待审核→已审核→上架→下架）
    - 记录所有变更操作
  * **输出/预期结果：** 商品信息成功保存，状态正确流转，变更记录完整

* **FR1.2 商品分类管理功能**
  * **描述：** 提供三级分类体系管理，支持分类的层级维护
  * **输入：** 分类名称、上级分类、排序、状态、商品数量统计
  * **处理逻辑：**
    - 支持最多3级分类层次
    - 自动生成分类ID
    - 统计各分类下商品数量
    - 分类删除时检查是否有关联商品
  * **输出/预期结果：** 分类体系结构清晰，商品归类准确

* **FR1.3 组合商品管理功能**
  * **描述：** 支持多个单品组合成套餐商品，实现营销策略
  * **输入：** 组合商品名称、包含的单品列表、各单品数量、组合价格、优惠金额
  * **处理逻辑：**
    - 从商品库中选择单品组成组合
    - 自动计算原价和优惠金额
    - 支持组合商品库存计算
    - 组合商品状态管理
  * **输出/预期结果：** 组合商品创建成功，价格计算准确，库存同步正确

#### **模块二：审批流程管理模块**

* **FR2.1 审批流程配置功能**
  * **描述：** 支持不同类型操作的审批流程配置和管理
  * **输入：** 审批类型、审批节点、审批人员、审批规则
  * **处理逻辑：**
    - 配置不同操作的审批流程
    - 设置审批人员和权限
    - 定义审批条件和规则
    - 支持多级审批流程
  * **输出/预期结果：** 审批流程配置完整，规则执行准确

* **FR2.2 审批申请提交功能**
  * **描述：** 支持用户提交各类审批申请，记录申请详情
  * **输入：** 申请类型、申请对象、申请数据、申请原因
  * **处理逻辑：**
    - 生成唯一审批单号
    - 验证申请数据完整性
    - 记录申请时间和申请人
    - 自动分配审批人员
  * **输出/预期结果：** 审批申请成功提交，状态正确流转

* **FR2.3 审批处理功能**
  * **描述：** 支持审批人员处理审批申请，记录审批结果
  * **输入：** 审批单号、审批意见、审批结果
  * **处理逻辑：**
    - 验证审批人员权限
    - 记录审批时间和意见
    - 执行审批结果（通过/拒绝）
    - 触发后续业务流程
  * **输出/预期结果：** 审批结果准确执行，相关数据同步更新

#### **模块三：变更记录管理模块**

* **FR5.1 操作日志记录功能**
  * **描述：** 记录所有重要操作的详细日志，支持审计追踪
  * **输入：** 操作类型、操作对象、操作前后值、操作人、操作时间
  * **处理逻辑：**
    - 自动记录所有CRUD操作
    - 记录操作前后的数据对比
    - 支持按时间、操作人、操作类型筛选
    - 提供操作回滚功能（特定场景）
  * **输出/预期结果：** 操作记录完整，追溯便捷

### 3.2 数据需求 (Data Requirements)

#### **数据实体一：商品基础信息 (Product)**
* **属性：** 商品ID、SKU编码、商品名称、商品规格、条形码、分类ID、销售单位、重量、重量单位、体积、体积单位、默认销售价格、状态、创建时间、更新时间、创建人、更新人
* **来源：** 商品维护表单录入
* **存储：** 关系型数据库products表

#### **数据实体二：商品分类 (Category)**
* **属性：** 分类ID、分类名称、上级分类ID、分类级别、排序序号、商品数量、状态、创建时间
* **来源：** 分类管理表单录入
* **存储：** 关系型数据库categories表

#### **数据实体三：组合商品 (ComboProduct)**
* **属性：** 组合商品ID、组合商品名称、组合价格、原价总计、优惠金额、状态、库存数量、销售数量、包含商品列表、创建时间
* **来源：** 组合商品配置表单
* **存储：** 关系型数据库combo_products表和combo_items表

#### **数据实体四：审批记录 (ApprovalRecord)**
* **属性：** 审批记录ID、审批单号、审批对象类型、审批对象ID、审批类型、当前状态、申请人、申请时间、审批人、审批时间、审批意见、申请原因、审批数据
* **来源：** 审批流程管理模块
* **存储：** 关系型数据库approval_records表

#### **数据实体五：变更记录 (ChangeRecord)**
* **属性：** 记录ID、商品ID、变更类型、变更字段、变更描述、操作人、操作时间、变更前值、变更后值、变更原因、审核人、审核状态
* **来源：** 系统自动记录
* **存储：** 关系型数据库change_records表

### 3.3 非功能需求 (Non-functional Requirements)

* **性能：** 
  - 商品查询响应时间 < 1秒
  - 支持1000+商品并发操作
  - 价格历史查询支持分页加载
  - 库存实时更新延迟 < 3秒

* **可用性：** 
  - 提供直观的商品分类树形导航
  - 支持多条件组合搜索
  - 批量操作支持进度显示
  - 错误提示信息明确具体
  - 表单数据校验实时反馈

* **安全性：** 
  - 重要操作需要二次确认
  - 价格调整需要审核机制
  - 操作日志完整记录
  - 数据变更可追溯回滚
  - 用户权限分级管理

* **兼容性：** 
  - 支持主流浏览器（Chrome、Firefox、Safari、Edge）
  - 响应式设计适配不同屏幕尺寸
  - 支持批量导入Excel格式数据
  - 提供数据导出功能

## 4. 核心业务流程 (Core Business Flows)

### **流程一：商品上架流程**
1. 商品管理员进入商品维护页面
2. 点击"新增商品"按钮，填写商品基础信息
3. 选择商品分类，设置价格信息
4. 保存为草稿状态，进行信息校验
5. 提交审核，流转到待审核状态  
6. 审核通过后，商品状态变为已审核
7. 手动上架或定时上架，商品可正常销售

### **流程二：商品审批流程**
1. 商品管理员提交商品相关申请（新增、修改、上下架）
2. 系统生成审批单号，记录申请信息
3. 自动分配给相应的审批人员
4. 审批人员查看申请详情和变更数据
5. 填写审批意见，确认审批结果
6. 审批通过后，系统执行相应操作
7. 通知申请人审批结果，完成流程

### **流程三：组合商品创建流程**  
1. 商品管理员创建组合商品申请
2. 选择包含的单品和设置数量
3. 配置组合价格和优惠策略
4. 提交组合商品审批申请
5. 审批人员审核组合配置合理性
6. 审批通过后，组合商品生效
7. 系统更新商品状态和库存信息

## 5. 假设与约束 (Assumptions and Constraints)

### **技术假设：**
* 使用React前端框架，Ant Design组件库
* 后端API服务支持RESTful规范
* 数据库采用关系型数据库设计
* 支持现代浏览器环境

### **功能约束：**
* 商品分类最多支持3级层次结构
* 组合商品最多包含20个子商品
* 重要操作需要通过审批流程确认
* 审批申请人和审批人不能为同一人
* 审批记录需要永久保存，不可删除

### **数据约束：**
* SKU编码系统内唯一
* 条形码全局唯一性校验
* 商品名称长度限制100字符
* 审批单号系统内唯一
* 审批数据必须为有效JSON格式

---

**文档版本：** V1.1  
**文档创建时间：** 2025年6月18日  
**文档创建人：** 系统分析员  
**最后更新时间：** 2025年7月03日 