
# src/pages 目录结构分析与统一方案

## 1. 背景

当前项目 `src/pages` 目录下的功能模块在文件组织结构上存在多种模式，缺乏统一标准。这可能导致新成员上手困难、可维护性下降以及与 `designrules.mdc` 设计规范不一致等问题。本文档旨在分析现有结构，并提出统一的、符合规范的目录组织方案。

## 2. 现有目录结构分析

通过对 `src/pages` 目录的深入分析，我们识别出以下三种主要结构模式：

### 模式一：标准模块结构 (完全符合规范)

这种结构遵循了高内聚的设计原则，将一个完整功能模块所需的文件都组织在一起。

-   **结构特征**:
    -   `index.js`: 模块主入口组件。
    -   `index.css`: 模块专属样式。
    -   `components/`: 存放仅供该模块使用的私有子组件。
    -   `services/`: 存放与该模块相关的 API 请求或服务。
-   **对应功能示例**:
    -   `src/pages/organization`: 组织架构管理
    -   `src/pages/oil/density`: 油品密度管理
    -   `src/pages/purchase/non-oil-procurement`: 非油品采购
-   **评价**: **(推荐)** 此模式完全符合 `designrules.mdc` 的规范，结构清晰，职责分明，是理想的组织方式。

### 模式二：功能集合结构 (部分符合规范)

这种结构将多个相关但平级的功能页面聚合在一个目录中，但没有统一的模块入口。

-   **结构特征**:
    -   一个目录下包含多个并列的 `.js` 文件，每个文件是一个独立的页面。
    -   可能包含一个共享的 `components` 目录。
-   **对应功能示例**:
    -   `src/pages/goods`: 包含 `CategoryManagement.js`, `ProductMaintenance.js` 等多个功能页面。
    -   `src/pages/device`: 包含 `DeviceDetail.js`, `DeviceManagement.js` 等设备管理页面。
    -   `src/pages/membership`: 包含 `MemberCardManagement.js`, `MemberPointsManagement.js` 等会员管理页面。
    -   `src/pages/report`: 包含多个报表相关的独立页面文件。
    -   `src/pages/supplier`: 包含供应商管理相关的多个独立页面文件。
    -   `src/pages/system`: 包含系统管理相关的页面文件。
-   **评价**: **(不推荐)** 此模式违反了 `designrules.mdc` 中“一个模块一个入口”的原则。随着功能增加，会导致目录变得混乱，难以维护。

### 模式三：分组目录结构 (用于组织)

这种目录本身不实现业务逻辑，仅作为容器，用于对一组相关的业务模块进行逻辑上的归类。

-   **结构特征**:
    -   目录下只包含其他模块目录，不直接包含 `index.js` 等业务文件。
-   **对应功能示例**:
    -   `src/pages/oil`: 聚合了油品密度、油枪、油罐等多个子模块。
    -   `src/pages/purchase`: 聚合了油品采购、非油品采购等多个子模块。
    -   `src/pages/inventory`: 聚合了油品入库、调拨、加注等多个子模块（但也包含一个 `InventoryManagement.js` 文件）。
    -   `src/pages/sales`: 聚合了油品销售、非油品销售等子模块。
-   **评价**: **(推荐)** 这是一种合理的宏观组织方式，有助于在高层级上划分业务领域，使项目结构更有条理，与设计规范兼容。

### 模式四：混合结构 (部分符合规范)

这种结构在一个目录中同时包含标准模块的特征（如 `index.js`）和功能集合的特征（独立页面文件）。

-   **结构特征**:
    -   既有 `index.js` 入口文件，又有其他独立的页面文件。
    -   包含子目录，用于组织相关功能。
-   **对应功能示例**:
    -   `src/pages/points`: 有 `index.js` 入口，同时包含 `config/`, `details/` 等子模块。
    -   `src/pages/station`: 有 `index.js` 和 `index.css`，同时包含 `tank/`, `gun/` 等子目录。
-   **评价**: **(需改进)** 虽然部分符合规范，但结构不够清晰，建议明确是作为标准模块还是分组目录。

-   

## 3. 与 designrules.mdc 的一致性评估

`designrules.mdc` 中明确定义了推荐的目录结构：

```
src/
└── pages/
    └── [模块名]/
        ├── index.js
        ├── index.css
        ├── components/
        └── services/
```

-   **模式一 (标准模块结构)** 完全符合此规范。
-   **模式二 (功能集合结构)** 不符合此规范。
-   **模式三 (分组目录结构)** 是对规范的合理应用和扩展，用于管理多个模块。
-   **模式四 (混合结构)** 部分符合规范，但需要明确定位。

## 3.1. 详细目录分析结果

### 完全符合规范 ✅
- `src/pages/organization`: 标准模块结构
- `src/pages/oil/density`: 标准模块结构
- `src/pages/purchase/non-oil-procurement`: 标准模块结构

### 不符合规范 ❌ (功能集合结构)
- `src/pages/device`: 仅包含独立页面文件，无模块化组织
- `src/pages/membership`: 仅包含独立页面文件，无模块化组织
- `src/pages/report`: 包含大量独立报表页面文件，结构混乱
- `src/pages/supplier`: 包含多个独立页面文件和一个简单的 `index.js`
- `src/pages/system`: 包含独立页面文件和子目录，结构不清晰
- `src/pages/goods`: 之前已识别的功能集合结构

### 需要改进 ⚠️ (混合结构)
- `src/pages/points`: 有 `index.js` 但同时包含多个子目录
- `src/pages/station`: 有 `index.js` 和 `index.css`，但同时包含子目录
- `src/pages/inventory`: 既是分组目录又有独立页面文件

### 合理的分组目录 ✅
- `src/pages/oil`: 纯分组目录，仅包含子模块
- `src/pages/purchase`: 纯分组目录，仅包含子模块
- `src/pages/sales`: 基本是分组目录，但包含一些页面文件

## 4. 统一方案与重构建议

为了提升代码质量和开发效率，我们必须统一目录结构。

### 统一标准

**所有新功能模块都必须采用“标准模块结构”进行开发。**

### 重构建议

建议投入时间，分阶段将现有不规范的目录重构为标准结构。

1.  **首要目标**: `src/pages/goods` 目录。
    -   **策略**: 将 `goods` 视为一个“分组目录”。
    -   **步骤**:
        -   为 `CategoryManagement.js` 创建 `src/pages/goods/category/` 目录，并将其重命名为 `index.js`，相关文件也一并移入。
        -   为 `ProductMaintenance.js` 创建 `src/pages/goods/maintenance/` 目录，并进行类似的迁移。
        -   对其他文件也执行同样的操作，最终使 `goods` 目录本身只包含模块文件夹。

2.  **长期目标**: 全面审查 `src/pages` 下的所有目录，确保它们要么是“标准模块”，要么是“分组目录”。

### 示例：重构 `goods` 目录

**重构前:**
```
src/pages/goods/
├── CategoryManagement.js
├── CategoryManagement.css
├── ProductMaintenance.js
└── components/
```

**重构后:**
```
src/pages/goods/
├── category/
│   ├── index.js      (原 CategoryManagement.js)
│   └── index.css     (原 CategoryManagement.css)
├── maintenance/
│   ├── index.js      (原 ProductMaintenance.js)
│   └── components/
└── ... (其他子模块)
```

## 5. 详细重构计划

### 第一阶段：紧急重构 (功能集合结构)

这些目录违反设计规范，影响开发效率，需要优先处理：

1. **src/pages/device** → 拆分为子模块
2. **src/pages/membership** → 拆分为子模块  
3. **src/pages/report** → 按报表类型分组
4. **src/pages/supplier** → 重组为标准结构
5. **src/pages/system** → 明确模块职责
6. **src/pages/goods** → 已在示例中说明

### 第二阶段：结构优化 (混合结构)

这些目录部分符合规范，但需要明确定位：

1. **src/pages/points** → 决定是模块还是分组目录
2. **src/pages/station** → 优化模块与子目录关系
3. **src/pages/inventory** → 统一组织方式

### 第三阶段：完善分组 (分组目录)

确保分组目录的纯净性：

1. **src/pages/sales** → 移除独立页面文件

通过实施此方案，我们可以显著改善项目的可维护性和扩展性，并确保所有开发活动都遵循统一的最佳实践。 