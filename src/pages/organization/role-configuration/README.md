# 角色配置 - 油站关联功能

## 功能概述

在角色配置中新增了**油站关联配置**功能，允许不同层级的负责人跨组织管理加油站。

## 主要特性

### 1. 跨组织管理
- 支持角色跨越组织架构边界管理加油站
- 不受传统组织层级限制，灵活配置管理范围

### 2. 多层级选择
- **服务区层级多选**：选择服务区将自动包含其下所有加油站
- **油站层级多选**：可以单独选择特定的加油站
- 支持混合选择模式（既可选服务区，也可选特定油站）

### 3. 搜索与筛选
- **模糊搜索**：支持按服务区名称或油站名称搜索
- **实时筛选**：搜索结果实时更新，自动展开匹配的节点
- **清除功能**：一键清空搜索条件

### 4. 便捷操作
- **全选功能**：一键选择所有油站
- **清空功能**：一键清除所有选择
- **选中预览**：实时显示已选择的油站数量和详细信息

## 使用方法

### 角色配置页面
1. 进入"组织架构管理" > "角色配置"
2. 点击"新增角色"或"编辑"现有角色
3. 在权限配置面板中找到"油站关联配置"
4. 配置该角色可以管理的油站范围

### 油站选择器操作
1. **搜索油站**：在搜索框中输入服务区或油站名称
2. **选择服务区**：勾选服务区节点，将包含其下所有油站
3. **选择油站**：勾选特定油站节点
4. **快捷操作**：使用"全选所有油站"或"清空选择"按钮
5. **查看结果**：在底部查看已选择的油站列表

## 数据结构

### 角色权限数据
```json
{
  "permissions": {
    "pageOperations": [...],
    "dataScope": "self_org",
    "posDevices": [...],
    "associatedStations": [15, 16, 18, 19]  // 新增字段
  }
}
```

### 组织树数据
系统使用 `src/mock/organization/organizationData.json` 中的 `orgTreeData` 作为数据源，自动提取所有服务区和油站信息。

## 技术实现

### 组件结构
- **StationSelector.jsx**：油站选择器组件
- **RoleConfigModal.js**：角色配置弹窗（已扩展）
- **index.js**：角色配置主页面（已扩展）

### 主要功能
1. **数据提取**：从组织树中提取服务区和油站
2. **树形展示**：以树形结构展示服务区和油站关系
3. **搜索过滤**：支持名称模糊搜索和实时过滤
4. **状态管理**：维护选中状态和展开状态
5. **数据转换**：在UI格式和数据格式间转换

## 示例配置

### 集团CEO
- 关联所有油站：`[15, 16, 18, 19, 21, 22, 24, 25]`
- 可跨组织管理所有加油站

### 分公司总经理
- 关联本分公司油站：`[15, 16, 18, 19]`
- 管理第1分公司下的所有加油站

### 服务区经理
- 关联本服务区油站：`[15, 16]`
- 管理第1分公司-服务区-1下的加油站

### 站长
- 关联本油站：`[15]`
- 仅管理加油站-A

## 注意事项

1. **权限继承**：油站关联不影响原有的数据权限范围设置
2. **角色适用性**：所有组织类型的角色都可以配置油站关联
3. **数据同步**：修改角色配置后，需要重新分配给用户才能生效
4. **性能考虑**：大量油站时，建议使用搜索功能定位目标 